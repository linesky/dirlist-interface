' Gambas class file



Public Sub form_Close()
  
  
  
End

Public Sub Form_Open()
Dim f1 As File
f1 = Open "/tmp/dirlist" For Create 
Close f1
f1 = Open "/tmp/dirlist.out" For Create 
Close f1
f1.Save("/tmp/dirlist", "")
f1.Save("/tmp/dirlist.out", "")
  TextArea1.Text = ""

End

Public Sub Button1_Click()
Dim f1 As File
Dim a As String 
Dim aa As String 
f1 = Open "/tmp/dirlist" For Create 
Close f1
  f1.Save("/tmp/dirlist", TextBox4.Text & "\n")
  Shell "netcat " & TextBox1.Text & " " & TextBox2.Text & " < /tmp/dirlist > /tmp/dirlist.out"
  Sleep 1
  f1 = Open "/tmp/dirlist.out" For Input
  aa = ""
  While 1
    Line Input #f1, a
    aa = aa & "\n" & a
    If Eof(f1) Then Break
  Wend
  Close #f1
  TextArea1.Text = aa
  TextArea1.refresh()
  
End


